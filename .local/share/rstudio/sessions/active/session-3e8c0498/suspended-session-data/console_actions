{
    "type": [
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1
    ],
    "data": [
        "+ ",
        "  )",
        "> ",
        "ggsave(\"output/pca_biplots_all_years.png\", ",
        "+ ",
        "       combined_plot, ",
        "+ ",
        "       width = 20, height = 15, ",
        "+ ",
        "       dpi = 300, ",
        "+ ",
        "       bg = \"white\")",
        "Warning messages:\n1: ggrepel: 17 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n2: ggrepel: 17 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n3: ggrepel: 16 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n4: ggrepel: 14 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n5: ggrepel: 16 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n6: ggrepel: 17 unlabeled data poin",
        "ts (too many overlaps). Consider increasing max.overlaps \n",
        "> ",
        "# Function to create reversed PCA biplot",
        "> ",
        "create_year_pca_reversed <- function(year_data, year, important_species) {",
        "+ ",
        "    # Perform PCA",
        "+ ",
        "    species_pca <- rda(select(year_data, -station_temp, -year_temp))",
        "+ ",
        "    ",
        "+ ",
        "    # Extract scores - note the reversed roles",
        "+ ",
        "    species_scores <- data.frame(",
        "+ ",
        "        scores(species_pca, display = \"species\"),",
        "+ ",
        "        Species = rownames(scores(species_pca, display = \"species\"))",
        "+ ",
        "    ) %>%",
        "+ ",
        "        mutate(Species = format_species_names(Species))  # Format species names",
        "+ ",
        "    ",
        "+ ",
        "    station_loadings <- data.frame(",
        "+ ",
        "        scores(species_pca, display = \"sites\"),",
        "+ ",
        "        Station = year_data$station_temp",
        "+ ",
        "    )",
        "+ ",
        "    ",
        "+ ",
        "    # Calculate variance explained",
        "+ ",
        "    var_explained <- round(summary(species_pca)$cont$importance[2,1:2] * 100, 1)",
        "+ ",
        "    ",
        "+ ",
        "    # Set consistent axis limits across all plots",
        "+ ",
        "    axis_limits <- max(abs(c(",
        "+ ",
        "        species_scores$PC1, species_scores$PC2,",
        "+ ",
        "        station_loadings$PC1, station_loadings$PC2",
        "+ ",
        "    ))) * 1.2  # Add 20% padding",
        "+ ",
        "    ",
        "+ ",
        "    # Create reversed PCA biplot",
        "+ ",
        "    pca_plot <- ggplot() +",
        "+ ",
        "        # Add species points",
        "+ ",
        "        geom_point(data = species_scores,",
        "+ ",
        "                   aes(x = PC1, y = PC2),",
        "+ ",
        "                   size = 2,",
        "+ ",
        "                   shape = 19,",
        "+ ",
        "                   color = \"black\") +",
        "+ ",
        "        # Add station arrows",
        "+ ",
        "        geom_segment(data = station_loadings,",
        "+ ",
        "                     aes(x = 0, y = 0, xend = PC1, yend = PC2),",
        "+ ",
        "                     arrow = arrow(length = unit(0.2, \"cm\")),",
        "+ ",
        "                     color = \"darkgrey\") +",
        "+ ",
        "        # Add station labels",
        "+ ",
        "        geom_text_repel(data = station_loadings,",
        "+ ",
        "                        aes(x = PC1, y = PC2, label = Station),",
        "+ ",
        "                        size = 3.5,",
        "+ ",
        "                        fontface = \"bold\",",
        "+ ",
        "                        box.padding = 0.5,",
        "+ ",
        "                        point.padding = 0.3) +",
        "+ ",
        "        # Add species labels",
        "+ ",
        "        geom_text_repel(data = species_scores,",
        "+ ",
        "                        aes(x = PC1, y = PC2, label = Species),",
        "+ ",
        "                        size = 2.8,",
        "+ ",
        "                        fontface = \"italic\",",
        "+ ",
        "                        color = \"grey30\",",
        "+ ",
        "                        box.padding = 0.5,",
        "+ ",
        "                        point.padding = 0.3) +",
        "+ ",
        "        # Set consistent axis limits",
        "+ ",
        "        coord_fixed(xlim = c(-axis_limits, axis_limits),",
        "+ ",
        "                    ylim = c(-axis_limits, axis_limits)) +",
        "+ ",
        "        theme_bw() +",
        "+ ",
        "        theme(",
        "+ ",
        "            panel.grid.minor = element_blank(),",
        "+ ",
        "            panel.grid.major = element_line(color = \"grey95\"),",
        "+ ",
        "            axis.text = element_text(color = \"black\", size = 8),",
        "+ ",
        "            axis.title = element_text(size = 10),",
        "+ ",
        "            plot.title = element_text(size = 11, face = \"bold\"),",
        "+ ",
        "            plot.subtitle = element_text(size = 9),",
        "+ ",
        "            plot.margin = margin(t = 10, r = 10, b = 10, l = 10)",
        "+ ",
        "        ) +",
        "+ ",
        "        labs(",
        "+ ",
        "            title = paste(\"PCA of benthic community composition -\", year),",
        "+ ",
        "            subtitle = \"Species shown as points, stations as arrows\",",
        "+ ",
        "            x = paste0(\"PC1 (\", var_explained[1], \"%)\"),",
        "+ ",
        "            y = paste0(\"PC2 (\", var_explained[2], \"%)\")",
        "+ ",
        "        )",
        "+ ",
        "    ",
        "+ ",
        "    return(pca_plot)",
        "+ ",
        "}",
        "> ",
        "# Create reversed PCA plots for each year",
        "> ",
        "years <- sort(unique(species_matrix_all$year_temp))",
        "> ",
        "pca_plots_reversed <- list()",
        "> ",
        "for(year in years) {",
        "+ ",
        "  year_data <- species_matrix_all %>%",
        "+ ",
        "    filter(year_temp == year)",
        "+ ",
        "  ",
        "+ ",
        "  pca_plots_reversed[[as.character(year)]] <- create_year_pca_reversed(",
        "+ ",
        "    year_data, ",
        "+ ",
        "    year,",
        "+ ",
        "    dominant_species$species",
        "+ ",
        "  )",
        "+ ",
        "  ",
        "+ ",
        "  ggsave(",
        "+ ",
        "    paste0(\"output/pca_biplot_reversed_\", year, \".png\"),",
        "+ ",
        "    pca_plots_reversed[[as.character(year)]], ",
        "+ ",
        "    width = 10, height = 8, ",
        "+ ",
        "    dpi = 300, ",
        "+ ",
        "    bg = \"white\"",
        "+ ",
        "  )",
        "+ ",
        "}",
        "Warning messages:\n1: ggrepel: 101 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n2: ggrepel: 103 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n3: ggrepel: 101 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n4: ggrepel: 97 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n5: ggrepel: 99 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n6: ggrepel: 102 unlabeled data ",
        "points (too many overlaps). Consider increasing max.overlaps \n",
        "> ",
        "# Combine all reversed plots",
        "> ",
        "combined_plot_reversed <- wrap_plots(pca_plots_reversed, ncol = 2) +",
        "+ ",
        "  plot_annotation(",
        "+ ",
        "    title = \"Temporal changes in community composition (1999, 2013-2017)\",",
        "+ ",
        "    subtitle = \"Species shown as points, stations as arrows\",",
        "+ ",
        "    caption = \"Based on species abundance data. Only species with >1% relative abundance shown.\"",
        "+ ",
        "  )",
        "> ",
        "ggsave(\"output/pca_biplots_reversed_all_years.png\", ",
        "+ ",
        "       combined_plot_reversed, ",
        "+ ",
        "       width = 20, height = 15, ",
        "+ ",
        "       dpi = 300, ",
        "+ ",
        "       bg = \"white\")",
        "Warning messages:\n1: ggrepel: 104 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n2: ggrepel: 103 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n3: ggrepel: 102 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n4: ggrepel: 103 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n5: ggrepel: 102 unlabeled data points (too many overlaps). Consider increasing max.overlaps \n6: ggrepel: 103 unlabeled dat",
        "a points (too many overlaps). Consider increasing max.overlaps \n",
        "> ",
        "species_data <- henda_long_matched %>% # see 03_nmds_analysis.R",
        "+ ",
        "  group_by(station, year, species) %>%",
        "+ ",
        "  summarise(N = sum(adjusted_density), .groups = \"drop\") %>%",
        "+ ",
        "  pivot_wider(names_from = species, values_from = N, values_fill = 0)",
        "> ",
        "# Separate environmental and species data",
        "> ",
        "env_data <- data.frame(",
        "+ ",
        "  Station = factor(species_data$station, levels = c(\"C4\", \"E3\", \"E4\", \"B5\", \"B8\", \"A7\")),",
        "+ ",
        "  Year = factor(species_data$year)",
        "+ ",
        ")",
        "> ",
        "# Create species matrix (only numeric columns)",
        "> ",
        "species_matrix <- species_data %>% ",
        "+ ",
        "  select(-station, -year) %>% ",
        "+ ",
        "  as.matrix()",
        "> ",
        "# Perform SIMPER analysis for year-to-year comparisons",
        "> ",
        "years <- sort(unique(as.character(env_data$Year)))",
        "> ",
        "sequential_simper <- list()",
        "> ",
        "for(i in 1:(length(years)-1)) {",
        "+ ",
        "  # Select data for consecutive years",
        "+ ",
        "  year_pair <- years[i:(i+1)]",
        "+ ",
        "  year_data <- species_matrix[env_data$Year %in% year_pair, ]",
        "+ ",
        "  year_groups <- env_data$Year[env_data$Year %in% year_pair]",
        "+ ",
        "  ",
        "+ ",
        "  # Perform SIMPER analysis for this pair of years",
        "+ ",
        "  comparison_name <- paste(year_pair[1], year_pair[2], sep=\"_\")",
        "+ ",
        "  sequential_simper[[comparison_name]] <- simper(year_data, group = year_groups, permutations = 999)",
        "+ ",
        "}",
        "> ",
        "# Baseline comparison (if 1999 data exists)",
        "> ",
        "if (\"1999\" %in% years) {",
        "+ ",
        "  baseline_data <- species_matrix[env_data$Year %in% c(\"1999\", years), ]",
        "+ ",
        "  baseline_groups <- env_data$Year[env_data$Year %in% c(\"1999\", years)]",
        "+ ",
        "  simper_baseline <- simper(baseline_data, group = baseline_groups, permutations = 999)",
        "+ ",
        "}",
        "> ",
        "# Calculate Benthic Biotic Indices (BBI) for each year and station",
        "> ",
        "calculate_biotic_indices <- function(data) {",
        "+ ",
        "  required_cols <- c(\"year\", \"station\", \"species\", \"adjusted_density\")",
        "+ ",
        "  stopifnot(",
        "+ ",
        "    \"Missing required columns\" = all(required_cols %in% colnames(data)),",
        "+ ",
        "    \"No data provided\" = nrow(data) > 0,",
        "+ ",
        "    \"Negative density values found\" = all(data$adjusted_density >= 0),",
        "+ ",
        "    \"Missing values found\" = !any(is.na(data$adjusted_density))",
        "+ ",
        "  )",
        "+ ",
        "  ",
        "+ ",
        "  target_stations <- c(\"C4\", \"A7\", \"B5\", \"B8\", \"E4\", \"E3\")",
        "+ ",
        "  indices_list <- list()",
        "+ ",
        "  species_ambi_mapping <- data.frame(species = character(), AMBI = numeric())",
        "+ ",
        "  ",
        "+ ",
        "  for (current_year in sort(unique(data$year))) {",
        "+ ",
        "    year_data <- data %>%",
        "+ ",
        "      filter(year == current_year, station %in% target_stations) %>%",
        "+ ",
        "      group_by(station, species) %>%",
        "+ ",
        "      summarise(density = sum(adjusted_density), .groups = 'drop') %>%",
        "+ ",
        "      pivot_wider(names_from = station, values_from = density, values_fill = 0)",
        "+ ",
        "    ",
        "+ ",
        "    bbi_results <- BBI(year_data)",
        "+ ",
        "    ",
        "+ ",
        "    # Extract and accumulate species-AMBI mappings",
        "+ ",
        "    current_species_groups <- data.frame(",
        "+ ",
        "      species = bbi_results$taxa[, 1],",
        "+ ",
        "      AMBI = bbi_results$table$AMBI",
        "+ ",
        "    )",
        "+ ",
        "    ",
        "+ ",
        "    # Combine with existing mappings, keeping the first non-NA AMBI value for each species",
        "+ ",
        "    species_ambi_mapping <- bind_rows(species_ambi_mapping, current_species_groups) %>%",
        "+ ",
        "      group_by(species) %>%",
        "+ ",
        "      summarise(AMBI = first(na.omit(AMBI))) %>%",
        "+ ",
        "      ungroup()",
        "+ ",
        "    ",
        "+ ",
        "    indices_list[[as.character(current_year)]] <- list(",
        "+ ",
        "      indices = as.data.frame(cbind(bbi_results$BBI, year = current_year)),",
        "+ ",
        "      classification = bbi_results$BBIclass,",
        "+ ",
        "      normalized = as.data.frame(nEQR(bbi_results$BBI)[1])",
        "+ ",
        "    )",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  # Add the species-AMBI mapping to the return list",
        "+ ",
        "  indices_list$species_groups <- species_ambi_mapping",
        "+ ",
        "  ",
        "+ ",
        "  return(indices_list)",
        "+ ",
        "}",
        "> ",
        "# Use the result dataframe that already has the correct density calculations",
        "> ",
        "biotic_indices <- calculate_biotic_indices(df_result)",
        "Processing : Abra nitida - 1 match in database so far\n   Found 1 matche for Abra nitida\n   Done - Abra nitida AMBI: 3\nProcessing : Ampharetidae - 1 match in database so far\n   Found 1 matche for Ampharetidae\n   Done - Ampharetidae AMBI: NA\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 matche for Chaetozone setosa\n   Done - Chaetozone setosa AMBI: 4\nProcessing : Cossura longocirrata - 1 match in database so far\n   Found 1 matche for Cossura longocirrata\n   Done - Cossura longocirrata",
        " AMBI: 4\nProcessing : Ennucula tenuis - 1 match in database so far\n   Found 1 matche for Ennucula tenuis\n   Done - Ennucula tenuis AMBI: 2\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Lanassa venusta - 1 match in database so far\n   Found 1 matche for Lanassa venusta\n   Done - Lanassa venusta AMBI: 1\nProcessing : Ophelina acuminata - 1 match in database so far\n   Found 1 matche for Ophelina acuminata\n   Done - Ophelina a",
        "cuminata AMBI: 3\nProcessing : Pectinaria granulata - 0 match in database so far\n   No match, trying exact match of the genus Pectinaria\n   Found 1 match for Pectinaria. Taking the median values of 1 multiple values\n   Done - Pectinaria AMBI value 1\nProcessing : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Praxillella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\nProcessin",
        "g : Protomedeia fasciata - 1 match in database so far\n   Found 1 matche for Protomedeia fasciata\n   Done - Protomedeia fasciata AMBI: 2\nProcessing : Scalibregma inflatum - 1 match in database so far\n   Found 1 matche for Scalibregma inflatum\n   Done - Scalibregma inflatum AMBI: 3\nProcessing : Schistomeringos nigridentata - 0 match in database so far\n   No match, trying exact match of the genus Schistomeringos\n   Found 1 match for Schistomeringos. Taking the median values of 1 multiple values\n   Done - Schis",
        "tomeringos AMBI value 2\nProcessing : Scoloplos armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Sternaspis scutata - 1 match in database so far\n   Found 1 matche for Sternaspis scutata\n   Done - Sternaspis scutat",
        "a AMBI: 3\nProcessing : Terebellides stroemii - 1 match in database so far\n   Found 1 matche for Terebellides stroemii\n   Done - Terebellides stroemii AMBI: 2\nProcessing : Apistobranchus tullbergi - 1 match in database so far\n   Found 1 matche for Apistobranchus tullbergi\n   Done - Apistobranchus tullbergi AMBI: 1\nProcessing : Arctica islandica - 1 match in database so far\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Dodecaceria concharum - 1 match in database so f",
        "ar\n   Found 1 matche for Dodecaceria concharum\n   Done - Dodecaceria concharum AMBI: 4\nProcessing : Macoma calcarea - 1 match in database so far\n   Found 1 matche for Macoma calcarea\n   Done - Macoma calcarea AMBI: 2\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nProcessing : Myriochele oculata - 1 match in database so far\n   Found 1 matche for Myriochele oculata\n   Done - Myriochele oculata AMBI: 3\nPr",
        "ocessing : Mytilus edulis - 2 match in database so far\n   Mytilus edulis matched 2 entries in database. Trying exact match\n   Found 1 match for Mytilus edulis\n   Done - Mytilus edulis AMBI value 3\nProcessing : Ophiuroidea - 1 match in database so far\n   Found 1 matche for Ophiuroidea\n   Done - Ophiuroidea AMBI: 2\nProcessing : Pholoe minuta - 1 match in database so far\n   Found 1 matche for Pholoe minuta\n   Done - Pholoe minuta AMBI: 2\nProcessing : Priapulus caudatus - 1 match in database so far\n   Found 1 m",
        "atche for Priapulus caudatus\n   Done - Priapulus caudatus AMBI: 3\nProcessing : Thyasira flexuosa - 1 match in database so far\n   Found 1 matche for Thyasira flexuosa\n   Done - Thyasira flexuosa AMBI: 3\nProcessing : Yoldia hyperborea - 1 match in database so far\n   Found 1 matche for Yoldia hyperborea\n   Done - Yoldia hyperborea AMBI: 1\nProcessing : Buccinum undatum - 1 match in database so far\n   Found 1 matche for Buccinum undatum\n   Done - Buccinum undatum AMBI: 2\nProcessing : Crenella decussata - 1 match",
        " in database so far\n   Found 1 matche for Crenella decussata\n   Done - Crenella decussata AMBI: 1\nProcessing : Cumacea - 1 match in database so far\n   Found 1 matche for Cumacea\n   Done - Cumacea AMBI: 1\nProcessing : Leda pernula - 0 match in database so far\n   No match, trying exact match of the genus Leda\n   No exact match, trying to match other species of the genus Leda\n   Not found.\nProcessing : Lumbrineris - 46 match in database so far\n   Lumbrineris matched 46 entries in database. Trying exact match\n ",
        "  No exact match. Trying exact match with Lumbrineris sp.\n   Found 1 match for Lumbrineris sp.\n   Done - Lumbrineris sp. AMBI value 2\nProcessing : Retusa pertenuis - 0 match in database so far\n   No match, trying exact match of the genus Retusa\n   Found 1 match for Retusa. Taking the median values of 1 multiple values\n   Done - Retusa AMBI value 2\nProcessing : Syllis gracilis - 1 match in database so far\n   Found 1 matche for Syllis gracilis\n   Done - Syllis gracilis AMBI: 2\nProcessing : Thracia villosiuscu",
        "la - 1 match in database so far\n   Found 1 matche for Thracia villosiuscula\n   Done - Thracia villosiuscula AMBI: 1\nProcessing : Caprella septentrionalis - 1 match in database so far\n   Found 1 matche for Caprella septentrionalis\n   Done - Caprella septentrionalis AMBI: 2\nProcessing : Munna - 7 match in database so far\n   Munna matched 7 entries in database. Trying exact match\n   No exact match. Trying exact match with Munna sp.\n   Found 0 match for Munna sp.\n   Taking median of the 0 match for Munna sp.\n  ",
        " Done - Munna sp. AMBI value NA\nProcessing : Musculus - 8 match in database so far\n   Musculus matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Musculus sp.\n   Found 1 match for Musculus sp.\n   Done - Musculus sp. AMBI value 1\nProcessing : Onoba aculeus - 1 match in database so far\n   Found 1 matche for Onoba aculeus\n   Done - Onoba aculeus AMBI: 1\nProcessing : Paroediceros lynceus - 1 match in database so far\n   Found 1 matche for Paroediceros lynceus\n   Done - P",
        "aroediceros lynceus AMBI: 1\nProcessing : Tubificoides benedii - 1 match in database so far\n   Found 1 matche for Tubificoides benedii\n   Done - Tubificoides benedii AMBI: 5\nProcessing : Astarte - 16 match in database so far\n   Astarte matched 16 entries in database. Trying exact match\n   No exact match. Trying exact match with Astarte sp.\n   Found 1 match for Astarte sp.\n   Done - Astarte sp. AMBI value 1\nProcessing : Cirratulus cirratus - 1 match in database so far\n   Found 1 matche for Cirratulus cirratus",
        "\n   Done - Cirratulus cirratus AMBI: 4\nProcessing : Crassicorophium bonellii - 1 match in database so far\n   Found 1 matche for Crassicorophium bonellii\n   Done - Crassicorophium bonellii AMBI: 3\nProcessing : Heteromastus filiformis - 1 match in database so far\n   Found 1 matche for Heteromastus filiformis\n   Done - Heteromastus filiformis AMBI: 4\nProcessing : Laphania boecki - 1 match in database so far\n   Found 1 matche for Laphania boecki\n   Done - Laphania boecki AMBI: 2\nProcessing : Levinsenia gracilis",
        " - 1 match in database so far\n   Found 1 matche for Levinsenia gracilis\n   Done - Levinsenia gracilis AMBI: 3\nProcessing : Phyllodoce maculata - 1 match in database so far\n   Found 1 matche for Phyllodoce maculata\n   Done - Phyllodoce maculata AMBI: 2\nProcessing : Polydora - 50 match in database so far\n   Polydora matched 50 entries in database. Trying exact match\n   No exact match. Trying exact match with Polydora sp.\n   Found 1 match for Polydora sp.\n   Done - Polydora sp. AMBI value 4\nProcessing : Pseudo",
        "potamilla reniformis - 1 match in database so far\n   Found 1 matche for Pseudopotamilla reniformis\n   Done - Pseudopotamilla reniformis AMBI: 2\nProcessing : Sphaerodoridae - 1 match in database so far\n   Found 1 matche for Sphaerodoridae\n   Done - Sphaerodoridae AMBI: NA\nProcessing : Syllis cornuta - 2 match in database so far\n   Syllis cornuta matched 2 entries in database. Trying exact match\n   Found 1 match for Syllis cornuta\n   Done - Syllis cornuta AMBI value 2\nProcessing : Aricidea suecica - 3 match i",
        "n database so far\n   Aricidea suecica matched 3 entries in database. Trying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\n==== Found match : 54  Not found : 1 ====\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\nProcessing : Capitella capitata - 1 match in database so far\n   Found 1 matche for Capitella capitata\n   Done - Capitella capitata AMBI: 5\nProcessing : Acarina - 1 match in database so far\n   Found 1 match",
        "e for Acarina\n   Done - Acarina AMBI: 1\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Tubificoides kozloffi - 0 match in database so far\n   No match, trying exact match",
        " of the genus Tubificoides\n   Found 1 match for Tubificoides. Taking the median values of 1 multiple values\n   Done - Tubificoides AMBI value 5\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Arctica islandica - 1 match in database so far\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Aricidea suecica - 3 match in database so far\n   Aricidea suecica matched 3 entries in database. T",
        "rying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 matche for Chaetozone setosa\n   Done - Chaetozone setosa AMBI: 4\nProcessing : Eunoe nodosa - 1 match in database so far\n   Found 1 matche for Eunoe nodosa\n   Done - Eunoe nodosa AMBI: 2\nProcessing : Harmothoe extenuata - 1 match in database so far\n   Found 1 matche for Harmothoe extenuata\n   Done - Harmothoe extenuata AMBI: 2\nProcessing : Harm",
        "othoe imbricata - 1 match in database so far\n   Found 1 matche for Harmothoe imbricata\n   Done - Harmothoe imbricata AMBI: 2\nProcessing : Mediomastus fragilis - 1 match in database so far\n   Found 1 matche for Mediomastus fragilis\n   Done - Mediomastus fragilis AMBI: 3\nProcessing : Scoloplos armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Tubificoides benedii - 1 match in database so far\n   Found 1 matche for Tubificoides benedii\n",
        "   Done - Tubificoides benedii AMBI: 5\nProcessing : Cossura longocirrata - 1 match in database so far\n   Found 1 matche for Cossura longocirrata\n   Done - Cossura longocirrata AMBI: 4\nProcessing : Crassicorophium bonellii - 1 match in database so far\n   Found 1 matche for Crassicorophium bonellii\n   Done - Crassicorophium bonellii AMBI: 3\nProcessing : Levinsenia gracilis - 1 match in database so far\n   Found 1 matche for Levinsenia gracilis\n   Done - Levinsenia gracilis AMBI: 3\nProcessing : Ophiuroidea - 1 ",
        "match in database so far\n   Found 1 matche for Ophiuroidea\n   Done - Ophiuroidea AMBI: 2\nProcessing : Polyplacophora - 1 match in database so far\n   Found 1 matche for Polyplacophora\n   Done - Polyplacophora AMBI: NA\nProcessing : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Praxillella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\n==== Found match : 21  Not found : 0 ====",
        "\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\nProcessing : Capitella capitata - 1 match in database so far\n   Found 1 matche for Capitella capitata\n   Done - Capitella capitata AMBI: 5\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Malacoceros fuliginosus - 1 match in database so far\n   Found 1 matche for Malacoceros fuliginosus\n   Done - Malacoceros fuliginosus AMBI: ",
        "5\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 matche for Chaetozone setosa\n   Done - Chaetozone setosa AMBI:",
        " 4\nProcessing : Cirratulus cirratus - 1 match in database so far\n   Found 1 matche for Cirratulus cirratus\n   Done - Cirratulus cirratus AMBI: 4\nProcessing : Ennucula tenuis - 1 match in database so far\n   Found 1 matche for Ennucula tenuis\n   Done - Ennucula tenuis AMBI: 2\nProcessing : Euchone - 9 match in database so far\n   Euchone matched 9 entries in database. Trying exact match\n   No exact match. Trying exact match with Euchone sp.\n   Found 1 match for Euchone sp.\n   Done - Euchone sp. AMBI value 2\nPro",
        "cessing : Harmothoe extenuata - 1 match in database so far\n   Found 1 matche for Harmothoe extenuata\n   Done - Harmothoe extenuata AMBI: 2\nProcessing : Lanassa venusta - 1 match in database so far\n   Found 1 matche for Lanassa venusta\n   Done - Lanassa venusta AMBI: 1\nProcessing : Macoma calcarea - 1 match in database so far\n   Found 1 matche for Macoma calcarea\n   Done - Macoma calcarea AMBI: 2\nProcessing : Phyllodoce maculata - 1 match in database so far\n   Found 1 matche for Phyllodoce maculata\n   Done -",
        " Phyllodoce maculata AMBI: 2\nProcessing : Polydora - 50 match in database so far\n   Polydora matched 50 entries in database. Trying exact match\n   No exact match. Trying exact match with Polydora sp.\n   Found 1 match for Polydora sp.\n   Done - Polydora sp. AMBI value 4\nProcessing : Priapulus caudatus - 1 match in database so far\n   Found 1 matche for Priapulus caudatus\n   Done - Priapulus caudatus AMBI: 3\nProcessing : Protomedeia fasciata - 1 match in database so far\n   Found 1 matche for Protomedeia fascia",
        "ta\n   Done - Protomedeia fasciata AMBI: 2\nProcessing : Scoloplos armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Sphaerosyllis erinaceus - 1 match in database so far\n   Found 1 matche for Sphaerosyllis erinaceus\n   Done - Sphaerosyllis erinaceus AMBI: 2\nProcessing : Tubificoides kozloffi - 0 match in database so far\n   No match, trying exact match of the genus Tubificoides\n   Found 1 match for Tubificoides. Taking the median value",
        "s of 1 multiple values\n   Done - Tubificoides AMBI value 5\nProcessing : Mya truncata - 1 match in database so far\n   Found 1 matche for Mya truncata\n   Done - Mya truncata AMBI: 2\nProcessing : Mytilidae - 1 match in database so far\n   Found 1 matche for Mytilidae\n   Done - Mytilidae AMBI: NA\nProcessing : Arctica islandica - 1 match in database so far\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Arenicola marina - 1 match in database so far\n   Found 1 matche for Ar",
        "enicola marina\n   Done - Arenicola marina AMBI: 3\nProcessing : Lagis koreni - 1 match in database so far\n   Found 1 matche for Lagis koreni\n   Done - Lagis koreni AMBI: 4\nProcessing : Mediomastus fragilis - 1 match in database so far\n   Found 1 matche for Mediomastus fragilis\n   Done - Mediomastus fragilis AMBI: 3\nProcessing : Ophelina acuminata - 1 match in database so far\n   Found 1 matche for Ophelina acuminata\n   Done - Ophelina acuminata AMBI: 3\nProcessing : Syllis cornuta - 2 match in database so far\n",
        "   Syllis cornuta matched 2 entries in database. Trying exact match\n   Found 1 match for Syllis cornuta\n   Done - Syllis cornuta AMBI value 2\nProcessing : Tubificoides benedii - 1 match in database so far\n   Found 1 matche for Tubificoides benedii\n   Done - Tubificoides benedii AMBI: 5\nProcessing : Ampharetidae - 1 match in database so far\n   Found 1 matche for Ampharetidae\n   Done - Ampharetidae AMBI: NA\nProcessing : Amphitrite cirrata - 1 match in database so far\n   Found 1 matche for Amphitrite cirrata\n ",
        "  Done - Amphitrite cirrata AMBI: 1\nProcessing : Aricidea suecica - 3 match in database so far\n   Aricidea suecica matched 3 entries in database. Trying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\nProcessing : Asteroidea - 1 match in database so far\n   Found 1 matche for Asteroidea\n   Done - Asteroidea AMBI: 1\nProcessing : Caprella septemtrionalis - 0 match in database so far\n   No match, trying exact match of the genus Caprella\n   Found 1 match for Caprella. Ta",
        "king the median values of 1 multiple values\n   Done - Caprella AMBI value 2\nProcessing : Ciliatocardium ciliatum ciliatum - 0 match in database so far\n   No match, trying exact match of the genus Ciliatocardium\n   No exact match, trying to match other species of the genus Ciliatocardium\n   Found 1 match for Ciliatocardium. Taking the median values of 1 multiple values\n   Done - Ciliatocardium AMBI value 1\nProcessing : Hiatella arctica - 1 match in database so far\n   Found 1 matche for Hiatella arctica\n   Do",
        "ne - Hiatella arctica AMBI: 1\nProcessing : Mya arenaria - 1 match in database so far\n   Found 1 matche for Mya arenaria\n   Done - Mya arenaria AMBI: 2\nProcessing : Naineris quadricuspida - 1 match in database so far\n   Found 1 matche for Naineris quadricuspida\n   Done - Naineris quadricuspida AMBI: 1\nProcessing : Nephthys - 5 match in database so far\n   Nephthys matched 5 entries in database. Trying exact match\n   No exact match. Trying exact match with Nephthys sp.\n   Found 0 match for Nephthys sp.\n   Taki",
        "ng median of the 0 match for Nephthys sp.\n   Done - Nephthys sp. AMBI value NA\nProcessing : Nereis pelagica - 1 match in database so far\n   Found 1 matche for Nereis pelagica\n   Done - Nereis pelagica AMBI: 3\nProcessing : Onoba aculeus - 1 match in database so far\n   Found 1 matche for Onoba aculeus\n   Done - Onoba aculeus AMBI: 1\nProcessing : Pectinaria granulata - 0 match in database so far\n   No match, trying exact match of the genus Pectinaria\n   Found 1 match for Pectinaria. Taking the median values of",
        " 1 multiple values\n   Done - Pectinaria AMBI value 1\nProcessing : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Praxillella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\nProcessing : Praxillella praetermissa - 1 match in database so far\n   Found 1 matche for Praxillella praetermissa\n   Done - Praxillella praetermissa AMBI: 3\nProcessing : Tunicata - 0 match in database so f",
        "ar\n   No match, trying exact match of the genus Tunicata\n   No exact match, trying to match other species of the genus Tunicata\n   Not found.\nProcessing : Dodecaceria concharum - 1 match in database so far\n   Found 1 matche for Dodecaceria concharum\n   Done - Dodecaceria concharum AMBI: 4\nProcessing : Sabellida - 1 match in database so far\n   Found 1 matche for Sabellida\n   Done - Sabellida AMBI: 1\nProcessing : Terebellides stroemii - 1 match in database so far\n   Found 1 matche for Terebellides stroemii\n  ",
        " Done - Terebellides stroemii AMBI: 2\n==== Found match : 46  Not found : 1 ====\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\nProcessing : Aricidea suecica - 3 match in database so far\n   Aricidea suecica matched 3 entries in database. Trying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\nProcessing : Crenella decussata - 1 match in database so far\n   Found 1 matche for Crenella decussata\n   Done - Crenella decus",
        "sata AMBI: 1\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Lagis koreni - 1 match in database so far\n   Found 1 matche for Lagis koreni\n   Done - Lagis koreni AMBI: 4\nProcessing : Macoma calcarea - 1 match in database so far\n   Found 1 matche for Macoma calcarea\n   Done - Macoma calcarea AMBI: 2\nProcessing : Mediomastus fragilis - 1 match in database so far\n   Found 1 matche for Mediomastus fragilis\n   Done - Mediomastus",
        " fragilis AMBI: 3\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nProcessing : Mya arenaria - 1 match in database so far\n   Found 1 matche for Mya arenaria\n   Done - Mya arenaria AMBI: 2\nProcessing : Nepthys - 0 match in database so far\n   No match, trying exact match of the genus Nepthys\n   No exact match, trying to match other species of the genus Nepthys\n   Not found.\nProcessing : Ophelina acuminata ",
        "- 1 match in database so far\n   Found 1 matche for Ophelina acuminata\n   Done - Ophelina acuminata AMBI: 3\nProcessing : Polydora - 50 match in database so far\n   Polydora matched 50 entries in database. Trying exact match\n   No exact match. Trying exact match with Polydora sp.\n   Found 1 match for Polydora sp.\n   Done - Polydora sp. AMBI value 4\nProcessing : Scalibregma inflatum - 1 match in database so far\n   Found 1 matche for Scalibregma inflatum\n   Done - Scalibregma inflatum AMBI: 3\nProcessing : Scolop",
        "los armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Sphaerosyllis erinaceus - 1 match in database so far\n   Found 1 matche for Sphaerosyllis erinaceus\n   Done - Sphaerosyllis erinaceus AMBI: 2\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Capit",
        "ella capitata - 1 match in database so far\n   Found 1 matche for Capitella capitata\n   Done - Capitella capitata AMBI: 5\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 matche for Chaetozone setosa\n   Done - Chaetozone setosa AMBI: 4\nProcessing : Cirratulus cirratus - 1 match in database so far\n   Found 1 matche for Cirratulus cirratus\n   Done - Cirratulus cirratus AMBI: 4\nProcessing : Ennucula tenuis - 1 match in database so far\n   Found 1 matche for Ennucula tenuis\n   Done - Ennucul",
        "a tenuis AMBI: 2\nProcessing : Lanassa venusta - 1 match in database so far\n   Found 1 matche for Lanassa venusta\n   Done - Lanassa venusta AMBI: 1\nProcessing : Mytilus edulis - 2 match in database so far\n   Mytilus edulis matched 2 entries in database. Trying exact match\n   Found 1 match for Mytilus edulis\n   Done - Mytilus edulis AMBI value 3\nProcessing : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Prax",
        "illella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\nProcessing : Priapulus caudatus - 1 match in database so far\n   Found 1 matche for Priapulus caudatus\n   Done - Priapulus caudatus AMBI: 3\nProcessing : Terebellides stroemii - 1 match in database so far\n   Found 1 matche for Terebellides stroemii\n   Done - Terebellides stroemii AMBI: 2\nProcessing : Arenicola marina - 1 match in database so far\n   Found 1 matche for Arenicola marina\n   Done - Arenicola marina AMBI: 3\nProc",
        "essing : Galathowenia oculata - 2 match in database so far\n   Galathowenia oculata matched 2 entries in database. Trying exact match\n   Found 1 match for Galathowenia oculata\n   Done - Galathowenia oculata AMBI value 3\nProcessing : Harmothoe extenuata - 1 match in database so far\n   Found 1 matche for Harmothoe extenuata\n   Done - Harmothoe extenuata AMBI: 2\nProcessing : Pholoe minuta - 1 match in database so far\n   Found 1 matche for Pholoe minuta\n   Done - Pholoe minuta AMBI: 2\nProcessing : Syllis cornuta",
        " - 2 match in database so far\n   Syllis cornuta matched 2 entries in database. Trying exact match\n   Found 1 match for Syllis cornuta\n   Done - Syllis cornuta AMBI value 2\nProcessing : Tubificoides benedii - 1 match in database so far\n   Found 1 matche for Tubificoides benedii\n   Done - Tubificoides benedii AMBI: 5\nProcessing : Tubificoides kozloffi - 0 match in database so far\n   No match, trying exact match of the genus Tubificoides\n   Found 1 match for Tubificoides. Taking the median values of 1 multiple",
        " values\n   Done - Tubificoides AMBI value 5\nProcessing : Amphitrite cirrata - 1 match in database so far\n   Found 1 matche for Amphitrite cirrata\n   Done - Amphitrite cirrata AMBI: 1\nProcessing : Apistobranchus tullbergi - 1 match in database so far\n   Found 1 matche for Apistobranchus tullbergi\n   Done - Apistobranchus tullbergi AMBI: 1\nProcessing : Flabelligera affinis - 1 match in database so far\n   Found 1 matche for Flabelligera affinis\n   Done - Flabelligera affinis AMBI: 2\nProcessing : Glycera capita",
        "ta - 1 match in database so far\n   Found 1 matche for Glycera capitata\n   Done - Glycera capitata AMBI: 2\nProcessing : Hiatella arctica - 1 match in database so far\n   Found 1 matche for Hiatella arctica\n   Done - Hiatella arctica AMBI: 1\nProcessing : Musculus - 8 match in database so far\n   Musculus matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Musculus sp.\n   Found 1 match for Musculus sp.\n   Done - Musculus sp. AMBI value 1\nProcessing : Nereimyra punctata - ",
        "1 match in database so far\n   Found 1 matche for Nereimyra punctata\n   Done - Nereimyra punctata AMBI: 3\nProcessing : Pectinaria granulata - 0 match in database so far\n   No match, trying exact match of the genus Pectinaria\n   Found 1 match for Pectinaria. Taking the median values of 1 multiple values\n   Done - Pectinaria AMBI value 1\nProcessing : Phyllodoce maculata - 1 match in database so far\n   Found 1 matche for Phyllodoce maculata\n   Done - Phyllodoce maculata AMBI: 2\nProcessing : Protomedeia fasciata",
        " - 1 match in database so far\n   Found 1 matche for Protomedeia fasciata\n   Done - Protomedeia fasciata AMBI: 2\nProcessing : Serripes groenlandicus - 1 match in database so far\n   Found 1 matche for Serripes groenlandicus\n   Done - Serripes groenlandicus AMBI: 1\nProcessing : Tunicata - 0 match in database so far\n   No match, trying exact match of the genus Tunicata\n   No exact match, trying to match other species of the genus Tunicata\n   Not found.\nProcessing : Arctica islandica - 1 match in database so far",
        "\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Cossura longocirrata - 1 match in database so far\n   Found 1 matche for Cossura longocirrata\n   Done - Cossura longocirrata AMBI: 4\nProcessing : Euchone - 9 match in database so far\n   Euchone matched 9 entries in database. Trying exact match\n   No exact match. Trying exact match with Euchone sp.\n   Found 1 match for Euchone sp.\n   Done - Euchone sp. AMBI value 2\nProcessing : Parougia nigridentata - 1 match in database",
        " so far\n   Found 1 matche for Parougia nigridentata\n   Done - Parougia nigridentata AMBI: NA\n==== Found match : 45  Not found : 2 ====\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\nProcessing : Ampharetidae - 1 match in database so far\n   Found 1 matche for Ampharetidae\n   Done - Ampharetidae AMBI: NA\nProcessing : Arctica islandica - 1 match in database so far\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Aricide",
        "a suecica - 3 match in database so far\n   Aricidea suecica matched 3 entries in database. Trying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\nProcessing : Capitella capitata - 1 match in database so far\n   Found 1 matche for Capitella capitata\n   Done - Capitella capitata AMBI: 5\nProcessing : Cardiidae - 1 match in database so far\n   Found 1 matche for Cardiidae\n   Done - Cardiidae AMBI: 3\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 mat",
        "che for Chaetozone setosa\n   Done - Chaetozone setosa AMBI: 4\nProcessing : Cossura longocirrata - 1 match in database so far\n   Found 1 matche for Cossura longocirrata\n   Done - Cossura longocirrata AMBI: 4\nProcessing : Crassicorophium bonellii - 1 match in database so far\n   Found 1 matche for Crassicorophium bonellii\n   Done - Crassicorophium bonellii AMBI: 3\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Heteromastus f",
        "iliformis - 1 match in database so far\n   Found 1 matche for Heteromastus filiformis\n   Done - Heteromastus filiformis AMBI: 4\nProcessing : Macoma calcarea - 1 match in database so far\n   Found 1 matche for Macoma calcarea\n   Done - Macoma calcarea AMBI: 2\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nProcessing : Mya arenaria - 1 match in database so far\n   Found 1 matche for Mya arenaria\n   Done - M",
        "ya arenaria AMBI: 2\nProcessing : Ophelina acuminata - 1 match in database so far\n   Found 1 matche for Ophelina acuminata\n   Done - Ophelina acuminata AMBI: 3\nProcessing : Polydora - 50 match in database so far\n   Polydora matched 50 entries in database. Trying exact match\n   No exact match. Trying exact match with Polydora sp.\n   Found 1 match for Polydora sp.\n   Done - Polydora sp. AMBI value 4\nProcessing : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact",
        " match\n   No exact match. Trying exact match with Praxillella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\nProcessing : Scalibregma inflatum - 1 match in database so far\n   Found 1 matche for Scalibregma inflatum\n   Done - Scalibregma inflatum AMBI: 3\nProcessing : Scoloplos armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Serripes groenlandicus - 1 match in database so far\n   Found 1 matche for Se",
        "rripes groenlandicus\n   Done - Serripes groenlandicus AMBI: 1\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Spionida - 1 match in database so far\n   Found 1 matche for Spionida\n   Done - Spionida AMBI: 3\nProcessing : Spionidae - 1 match in database so far\n   Found 1 matche for Spionidae\n   Done - Spionidae AMBI: 3\nProces",
        "sing : Syllis cornuta - 2 match in database so far\n   Syllis cornuta matched 2 entries in database. Trying exact match\n   Found 1 match for Syllis cornuta\n   Done - Syllis cornuta AMBI value 2\nProcessing : Cirratulus cirratus - 1 match in database so far\n   Found 1 matche for Cirratulus cirratus\n   Done - Cirratulus cirratus AMBI: 4\nProcessing : Ennucula tenuis - 1 match in database so far\n   Found 1 matche for Ennucula tenuis\n   Done - Ennucula tenuis AMBI: 2\nProcessing : Levinsenia gracilis - 1 match in d",
        "atabase so far\n   Found 1 matche for Levinsenia gracilis\n   Done - Levinsenia gracilis AMBI: 3\nProcessing : Nuculana pernula - 1 match in database so far\n   Found 1 matche for Nuculana pernula\n   Done - Nuculana pernula AMBI: 1\nProcessing : Sabellidae - 1 match in database so far\n   Found 1 matche for Sabellidae\n   Done - Sabellidae AMBI: 1\nProcessing : scalibregma inflatum - 1 match in database so far\n   Found 1 matche for scalibregma inflatum\n   Done - scalibregma inflatum AMBI: 3\nProcessing : Abra nitida",
        " - 1 match in database so far\n   Found 1 matche for Abra nitida\n   Done - Abra nitida AMBI: 3\nProcessing : Amphitrite cirrata - 1 match in database so far\n   Found 1 matche for Amphitrite cirrata\n   Done - Amphitrite cirrata AMBI: 1\nProcessing : Lagis koreni - 1 match in database so far\n   Found 1 matche for Lagis koreni\n   Done - Lagis koreni AMBI: 4\nProcessing : Lanassa venusta - 1 match in database so far\n   Found 1 matche for Lanassa venusta\n   Done - Lanassa venusta AMBI: 1\nProcessing : Lumbrineris - 4",
        "6 match in database so far\n   Lumbrineris matched 46 entries in database. Trying exact match\n   No exact match. Trying exact match with Lumbrineris sp.\n   Found 1 match for Lumbrineris sp.\n   Done - Lumbrineris sp. AMBI value 2\nProcessing : Nuculana minuta - 1 match in database so far\n   Found 1 matche for Nuculana minuta\n   Done - Nuculana minuta AMBI: 1\nProcessing : Parvicardium minimum - 1 match in database so far\n   Found 1 matche for Parvicardium minimum\n   Done - Parvicardium minimum AMBI: 1\nProcessin",
        "g : Pectinaria koreni - 2 match in database so far\n   Pectinaria koreni matched 2 entries in database. Trying exact match\n   Found 1 match for Pectinaria koreni\n   Done - Pectinaria koreni AMBI value 4\nProcessing : Pholoe minuta - 1 match in database so far\n   Found 1 matche for Pholoe minuta\n   Done - Pholoe minuta AMBI: 2\nProcessing : Priapulus caudatus - 1 match in database so far\n   Found 1 matche for Priapulus caudatus\n   Done - Priapulus caudatus AMBI: 3\nProcessing : Sphaerodoropsis minuta - 1 match i",
        "n database so far\n   Found 1 matche for Sphaerodoropsis minuta\n   Done - Sphaerodoropsis minuta AMBI: 2\nProcessing : Terebellides stroemii - 1 match in database so far\n   Found 1 matche for Terebellides stroemii\n   Done - Terebellides stroemii AMBI: 2\nProcessing : Abra prismatica - 1 match in database so far\n   Found 1 matche for Abra prismatica\n   Done - Abra prismatica AMBI: 1\nProcessing : Cistenides granulata - 1 match in database so far\n   Found 1 matche for Cistenides granulata\n   Done - Cistenides gra",
        "nulata AMBI: 1\nProcessing : Kurtiella bidentata - 1 match in database so far\n   Found 1 matche for Kurtiella bidentata\n   Done - Kurtiella bidentata AMBI: 3\nProcessing : Mediomastus fragilis - 1 match in database so far\n   Found 1 matche for Mediomastus fragilis\n   Done - Mediomastus fragilis AMBI: 3\nProcessing : Mytilidae - 1 match in database so far\n   Found 1 matche for Mytilidae\n   Done - Mytilidae AMBI: NA\nProcessing : Nephtyidae - 1 match in database so far\n   Found 1 matche for Nephtyidae\n   Done - N",
        "ephtyidae AMBI: 2\nProcessing : Nephtys - 39 match in database so far\n   Nephtys matched 39 entries in database. Trying exact match\n   No exact match. Trying exact match with Nephtys sp.\n   Found 1 match for Nephtys sp.\n   Done - Nephtys sp. AMBI value 2\nProcessing : Gattyana cirrhosa - 1 match in database so far\n   Found 1 matche for Gattyana cirrhosa\n   Done - Gattyana cirrhosa AMBI: 3\nProcessing : Harmothoe imbricata - 1 match in database so far\n   Found 1 matche for Harmothoe imbricata\n   Done - Harmotho",
        "e imbricata AMBI: 2\nProcessing : Hiatella arctica - 1 match in database so far\n   Found 1 matche for Hiatella arctica\n   Done - Hiatella arctica AMBI: 1\nProcessing : Phyllodoce maculata - 1 match in database so far\n   Found 1 matche for Phyllodoce maculata\n   Done - Phyllodoce maculata AMBI: 2\nProcessing : Protomedeia fasciata - 1 match in database so far\n   Found 1 matche for Protomedeia fasciata\n   Done - Protomedeia fasciata AMBI: 2\nProcessing : Acanthocardia tuberculata - 1 match in database so far\n   F",
        "ound 1 matche for Acanthocardia tuberculata\n   Done - Acanthocardia tuberculata AMBI: 1\nProcessing : Cumacea - 1 match in database so far\n   Found 1 matche for Cumacea\n   Done - Cumacea AMBI: 1\nProcessing : Eunoe nodosa - 1 match in database so far\n   Found 1 matche for Eunoe nodosa\n   Done - Eunoe nodosa AMBI: 2\nProcessing : Ophiuroidea - 1 match in database so far\n   Found 1 matche for Ophiuroidea\n   Done - Ophiuroidea AMBI: 2\nProcessing : Sphaerosyllis erinaceus - 1 match in database so far\n   Found 1 ma",
        "tche for Sphaerosyllis erinaceus\n   Done - Sphaerosyllis erinaceus AMBI: 2\nProcessing : Tubificoides kozloffi - 0 match in database so far\n   No match, trying exact match of the genus Tubificoides\n   Found 1 match for Tubificoides. Taking the median values of 1 multiple values\n   Done - Tubificoides AMBI value 5\n==== Found match : 59  Not found : 0 ====\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\nProcessing : Abra nitida - 1 match in database so far\n   ",
        "Found 1 matche for Abra nitida\n   Done - Abra nitida AMBI: 3\nProcessing : Arctica islandica - 1 match in database so far\n   Found 1 matche for Arctica islandica\n   Done - Arctica islandica AMBI: 3\nProcessing : Aricidea suecica - 3 match in database so far\n   Aricidea suecica matched 3 entries in database. Trying exact match\n   Found 1 match for Aricidea suecica\n   Done - Aricidea suecica AMBI value 1\nProcessing : Chaetozone setosa - 1 match in database so far\n   Found 1 matche for Chaetozone setosa\n   Done ",
        "- Chaetozone setosa AMBI: 4\nProcessing : Cossura longocirrata - 1 match in database so far\n   Found 1 matche for Cossura longocirrata\n   Done - Cossura longocirrata AMBI: 4\nProcessing : Crassicorophium bonellii - 1 match in database so far\n   Found 1 matche for Crassicorophium bonellii\n   Done - Crassicorophium bonellii AMBI: 3\nProcessing : Eteone longa - 1 match in database so far\n   Found 1 matche for Eteone longa\n   Done - Eteone longa AMBI: 3\nProcessing : Harmothoe extenuata - 1 match in database so far",
        "\n   Found 1 matche for Harmothoe extenuata\n   Done - Harmothoe extenuata AMBI: 2\nProcessing : Macoma calcarea - 1 match in database so far\n   Found 1 matche for Macoma calcarea\n   Done - Macoma calcarea AMBI: 2\nProcessing : Mediomastus fragilis - 1 match in database so far\n   Found 1 matche for Mediomastus fragilis\n   Done - Mediomastus fragilis AMBI: 3\nProcessing : Microphthalmus aberrans - 1 match in database so far\n   Found 1 matche for Microphthalmus aberrans\n   Done - Microphthalmus aberrans AMBI: 2\nPr",
        "ocessing : Onoba aculeus - 1 match in database so far\n   Found 1 matche for Onoba aculeus\n   Done - Onoba aculeus AMBI: 1\nProcessing : Ophelina acuminata - 1 match in database so far\n   Found 1 matche for Ophelina acuminata\n   Done - Ophelina acuminata AMBI: 3\nProcessing : Polydora - 50 match in database so far\n   Polydora matched 50 entries in database. Trying exact match\n   No exact match. Trying exact match with Polydora sp.\n   Found 1 match for Polydora sp.\n   Done - Polydora sp. AMBI value 4\nProcessing",
        " : Praxillella - 8 match in database so far\n   Praxillella matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Praxillella sp.\n   Found 1 match for Praxillella sp.\n   Done - Praxillella sp. AMBI value 3\nProcessing : Priapulus caudatus - 1 match in database so far\n   Found 1 matche for Priapulus caudatus\n   Done - Priapulus caudatus AMBI: 3\nProcessing : Scalibregma inflatum - 1 match in database so far\n   Found 1 matche for Scalibregma inflatum\n   Done - Scalibregma i",
        "nflatum AMBI: 3\nProcessing : Scoloplos armiger - 1 match in database so far\n   Found 1 matche for Scoloplos armiger\n   Done - Scoloplos armiger AMBI: 3\nProcessing : Spio - 106 match in database so far\n   Spio matched 106 entries in database. Trying exact match\n   No exact match. Trying exact match with Spio sp.\n   Found 1 match for Spio sp.\n   Done - Spio sp. AMBI value 3\nProcessing : Terebellides stroemii - 1 match in database so far\n   Found 1 matche for Terebellides stroemii\n   Done - Terebellides stroem",
        "ii AMBI: 2\nProcessing : Thyasira flexuosa - 1 match in database so far\n   Found 1 matche for Thyasira flexuosa\n   Done - Thyasira flexuosa AMBI: 3\nProcessing : Acanthocardia echinata - 1 match in database so far\n   Found 1 matche for Acanthocardia echinata\n   Done - Acanthocardia echinata AMBI: 1\nProcessing : Cossura pygodactylata - 1 match in database so far\n   Found 1 matche for Cossura pygodactylata\n   Done - Cossura pygodactylata AMBI: 4\nProcessing : Ennucula tenuis - 1 match in database so far\n   Found",
        " 1 matche for Ennucula tenuis\n   Done - Ennucula tenuis AMBI: 2\nProcessing : Lagis koreni - 1 match in database so far\n   Found 1 matche for Lagis koreni\n   Done - Lagis koreni AMBI: 4\nProcessing : Lanassa venusta - 1 match in database so far\n   Found 1 matche for Lanassa venusta\n   Done - Lanassa venusta AMBI: 1\nProcessing : Nepthys - 0 match in database so far\n   No match, trying exact match of the genus Nepthys\n   No exact match, trying to match other species of the genus Nepthys\n   Not found.\nProcessing",
        " : Notomastus latericeus - 1 match in database so far\n   Found 1 matche for Notomastus latericeus\n   Done - Notomastus latericeus AMBI: 3\nProcessing : Pycnogonida - 2 match in database so far\n   Pycnogonida matched 2 entries in database. Trying exact match\n   Found 1 match for Pycnogonida\n   Done - Pycnogonida AMBI value 2\nProcessing : Serripes groenlandicus - 1 match in database so far\n   Found 1 matche for Serripes groenlandicus\n   Done - Serripes groenlandicus AMBI: 1\nProcessing : Tubificoides benedii - ",
        "1 match in database so far\n   Found 1 matche for Tubificoides benedii\n   Done - Tubificoides benedii AMBI: 5\nProcessing : Tubificoides kozloffi - 0 match in database so far\n   No match, trying exact match of the genus Tubificoides\n   Found 1 match for Tubificoides. Taking the median values of 1 multiple values\n   Done - Tubificoides AMBI value 5\nProcessing : Ampharetidae - 1 match in database so far\n   Found 1 matche for Ampharetidae\n   Done - Ampharetidae AMBI: NA\nProcessing : Amphipoda - 1 match in databa",
        "se so far\n   Found 1 matche for Amphipoda\n   Done - Amphipoda AMBI: NA\nProcessing : Apistobranchus tullbergi - 1 match in database so far\n   Found 1 matche for Apistobranchus tullbergi\n   Done - Apistobranchus tullbergi AMBI: 1\nProcessing : Mya arenaria - 1 match in database so far\n   Found 1 matche for Mya arenaria\n   Done - Mya arenaria AMBI: 2\nProcessing : Mytilidae - 1 match in database so far\n   Found 1 matche for Mytilidae\n   Done - Mytilidae AMBI: NA\nProcessing : Retusa pertenuis - 0 match in databas",
        "e so far\n   No match, trying exact match of the genus Retusa\n   Found 1 match for Retusa. Taking the median values of 1 multiple values\n   Done - Retusa AMBI value 2\nProcessing : Arenicola marina - 1 match in database so far\n   Found 1 matche for Arenicola marina\n   Done - Arenicola marina AMBI: 3\nProcessing : Protomedeia fasciata - 1 match in database so far\n   Found 1 matche for Protomedeia fasciata\n   Done - Protomedeia fasciata AMBI: 2\nProcessing : Syllis cornuta - 2 match in database so far\n   Syllis c",
        "ornuta matched 2 entries in database. Trying exact match\n   Found 1 match for Syllis cornuta\n   Done - Syllis cornuta AMBI value 2\nProcessing : Amphitrite cirrata - 1 match in database so far\n   Found 1 matche for Amphitrite cirrata\n   Done - Amphitrite cirrata AMBI: 1\nProcessing : Buccinum undatum - 1 match in database so far\n   Found 1 matche for Buccinum undatum\n   Done - Buccinum undatum AMBI: 2\nProcessing : Caprella septentrionalis - 1 match in database so far\n   Found 1 matche for Caprella septentrion",
        "alis\n   Done - Caprella septentrionalis AMBI: 2\nProcessing : Cirratulus cirratus - 1 match in database so far\n   Found 1 matche for Cirratulus cirratus\n   Done - Cirratulus cirratus AMBI: 4\nProcessing : Dexamine thea - 1 match in database so far\n   Found 1 matche for Dexamine thea\n   Done - Dexamine thea AMBI: 3\nProcessing : Euchone - 9 match in database so far\n   Euchone matched 9 entries in database. Trying exact match\n   No exact match. Trying exact match with Euchone sp.\n   Found 1 match for Euchone sp.",
        "\n   Done - Euchone sp. AMBI value 2\nProcessing : Flabelligera affinis - 1 match in database so far\n   Found 1 matche for Flabelligera affinis\n   Done - Flabelligera affinis AMBI: 2\nProcessing : Gibbula tumida - 1 match in database so far\n   Found 1 matche for Gibbula tumida\n   Done - Gibbula tumida AMBI: 1\nProcessing : Heteromastus filiformis - 1 match in database so far\n   Found 1 matche for Heteromastus filiformis\n   Done - Heteromastus filiformis AMBI: 4\nProcessing : Hiatella arctica - 1 match in databas",
        "e so far\n   Found 1 matche for Hiatella arctica\n   Done - Hiatella arctica AMBI: 1\nProcessing : Margarites groenlandicus - 1 match in database so far\n   Found 1 matche for Margarites groenlandicus\n   Done - Margarites groenlandicus AMBI: 1\nProcessing : Musculus - 8 match in database so far\n   Musculus matched 8 entries in database. Trying exact match\n   No exact match. Trying exact match with Musculus sp.\n   Found 1 match for Musculus sp.\n   Done - Musculus sp. AMBI value 1\nProcessing : Nicolea zostericola ",
        "- 1 match in database so far\n   Found 1 matche for Nicolea zostericola\n   Done - Nicolea zostericola AMBI: 2\nProcessing : Nudibranchia - 1 match in database so far\n   Found 1 matche for Nudibranchia\n   Done - Nudibranchia AMBI: NA\nProcessing : Onoba striata - 0 match in database so far\n   No match, trying exact match of the genus Onoba\n   Found 1 match for Onoba. Taking the median values of 1 multiple values\n   Done - Onoba AMBI value 1\nProcessing : Pectinaria granulata - 0 match in database so far\n   No ma",
        "tch, trying exact match of the genus Pectinaria\n   Found 1 match for Pectinaria. Taking the median values of 1 multiple values\n   Done - Pectinaria AMBI value 1\nProcessing : Pherusa plumosa - 1 match in database so far\n   Found 1 matche for Pherusa plumosa\n   Done - Pherusa plumosa AMBI: 3\nProcessing : Sabellida - 1 match in database so far\n   Found 1 matche for Sabellida\n   Done - Sabellida AMBI: 1\nProcessing : Sphaerosyllis erinaceus - 1 match in database so far\n   Found 1 matche for Sphaerosyllis erinace",
        "us\n   Done - Sphaerosyllis erinaceus AMBI: 2\nProcessing : Asteroidea - 1 match in database so far\n   Found 1 matche for Asteroidea\n   Done - Asteroidea AMBI: 1\nProcessing : Cumacea - 1 match in database so far\n   Found 1 matche for Cumacea\n   Done - Cumacea AMBI: 1\nProcessing : Galathowenia oculata - 2 match in database so far\n   Galathowenia oculata matched 2 entries in database. Trying exact match\n   Found 1 match for Galathowenia oculata\n   Done - Galathowenia oculata AMBI value 3\nProcessing : Naticidae ",
        "- 1 match in database so far\n   Found 1 matche for Naticidae\n   Done - Naticidae AMBI: 2\nProcessing : Parvicardium pinnulatum - 1 match in database so far\n   Found 1 matche for Parvicardium pinnulatum\n   Done - Parvicardium pinnulatum AMBI: 1\nProcessing : Pholoe minuta - 1 match in database so far\n   Found 1 matche for Pholoe minuta\n   Done - Pholoe minuta AMBI: 2\nProcessing : Phyllodoce maculata - 1 match in database so far\n   Found 1 matche for Phyllodoce maculata\n   Done - Phyllodoce maculata AMBI: 2\n===",
        "= Found match : 66  Not found : 1 ====\nBentix and ITI are being removed (if any), because not included in the nEQR assessment regulations\n",
        "> ",
        "# Extract species groups from the accumulated mappings",
        "> ",
        "species_groups <- biotic_indices$species_groups",
        "> ",
        "# Function to summarize one comparison and add ecological group",
        "> ",
        "summarize_one_comparison <- function(comparison_data, df_result, year1, year2, species_groups) {",
        "+ ",
        "  # Construct the dynamic key",
        "+ ",
        "  comparison_key <- paste(year1, year2, sep = \"_\")",
        "+ ",
        "  ",
        "+ ",
        "  # Access cusum and other components dynamically",
        "+ ",
        "  species_names <- names(comparison_data[[comparison_key]]$cusum)",
        "+ ",
        "  cumulative_contributions <- unname(comparison_data[[comparison_key]]$cusum)",
        "+ ",
        "  individual_contributions <- c(cumulative_contributions[1], diff(cumulative_contributions))",
        "+ ",
        "  ",
        "+ ",
        "  ",
        "+ ",
        "  abundance_changes <- sapply(species_names, function(species) {",
        "+ ",
        "    abundance_year1 <- sum(df_result$adjusted_density[df_result$species == species & df_result$year == year1])",
        "+ ",
        "    abundance_year2 <- sum(df_result$adjusted_density[df_result$species == species & df_result$year == year2])",
        "+ ",
        "    change <- abundance_year2 - abundance_year1",
        "+ ",
        "    return(change)",
        "+ ",
        "  })",
        "+ ",
        "  ",
        "+ ",
        "  ecological_groups <- sapply(species_names, function(species) {",
        "+ ",
        "    match_index <- match(species, species_groups$species)",
        "+ ",
        "    if (!is.na(match_index)) {",
        "+ ",
        "      return(species_groups$AMBI[match_index])",
        "+ ",
        "    } else {",
        "+ ",
        "      return(NA)",
        "+ ",
        "    }",
        "+ ",
        "  })",
        "+ ",
        "  ",
        "+ ",
        "  df <- data.frame(",
        "+ ",
        "    Species = species_names,",
        "+ ",
        "    Cumulative_Percent = cumulative_contributions * 100,",
        "+ ",
        "    Individual_Percent = individual_contributions * 100,",
        "+ ",
        "    Abundance_Change = abundance_changes,",
        "+ ",
        "    Ecological_Group = ecological_groups",
        "+ ",
        "  )",
        "+ ",
        "  ",
        "+ ",
        "  return(df)",
        "+ ",
        "}",
        "> ",
        "# Process sequential comparisons",
        "> ",
        "print(\"Sequential Year Comparisons:\")",
        "[1] \"Sequential Year Comparisons:\"\n",
        "> ",
        "for(i in seq_along(sequential_simper)) {",
        "+ ",
        "  comparison_name <- names(sequential_simper)[i]",
        "+ ",
        "  years <- unlist(strsplit(comparison_name, \"_\"))",
        "+ ",
        "  year1 <- years[1]",
        "+ ",
        "  year2 <- years[2]",
        "+ ",
        "  ",
        "+ ",
        "  cat(sprintf(\"\\nComparison: %s\\n\", comparison_name))",
        "+ ",
        "  ",
        "+ ",
        "  # Process this comparison",
        "+ ",
        "  summary_data <- summarize_one_comparison(sequential_simper[[i]], df_result, year1, year2, species_groups) %>%",
        "+ ",
        "    filter(Cumulative_Percent <= 70) %>%",
        "+ ",
        "    mutate(",
        "+ ",
        "      Species = format_species_names(Species)",
        "+ ",
        "    ) %>%",
        "+ ",
        "    mutate_if(is.numeric, ~ round(.x, 2))  # Round all numeric columns to 2 decimal places",
        "+ ",
        "  rownames(summary_data) <- NULL",
        "+ ",
        "  # Apply line breaks to column names",
        "+ ",
        "  colnames(summary_data) <- gsub(\"_\", \"<br>\", colnames(summary_data))",
        "+ ",
        "  ",
        "+ ",
        "  if(nrow(summary_data) > 0) {",
        "+ ",
        "    # Export the summary data to a CSV file with a descriptive filename",
        "+ ",
        "    #file_name <- sprintf(\"species_contributions_sequential_%s_%s.csv\", year1, year2)",
        "+ ",
        "    #write.csv(summary_data, file = file_name, row.names = FALSE)",
        "+ ",
        "    ",
        "+ ",
        "    # Print the table in console for reference",
        "+ ",
        "    print(",
        "+ ",
        "      kableExtra::kbl(",
        "+ ",
        "        summary_data,",
        "+ ",
        "        caption = sprintf(\"Species contributions for %s\", comparison_name),",
        "+ ",
        "        digits = 2,",
        "+ ",
        "        format = \"html\",",
        "+ ",
        "        escape = F",
        "+ ",
        "      ) %>%",
        "+ ",
        "        kableExtra::kable_styling(",
        "+ ",
        "          full_width = FALSE,",
        "+ ",
        "          bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")",
        "+ ",
        "        ) %>%",
        "+ ",
        "        kableExtra::row_spec(0, bold = TRUE, color = \"black\", background = \"#f0f0f0\") %>%  # Header styling",
        "+ ",
        "        kableExtra::column_spec(1, bold = TRUE, width = \"5em\") %>%  # First column bold",
        "+ ",
        "        kableExtra::add_header_above(c(\" \" = 1, \"Species Contributions\" = ncol(summary_data) - 1))  # Custom header",
        "+ ",
        "    )",
        "+ ",
        "    ",
        "+ ",
        "    cat(sprintf(\"Exported summary data for %s to %s\\n\", comparison_name, file_name))",
        "+ ",
        "  } else {",
        "+ ",
        "    cat(\"No species met the contribution threshold for this comparison.\\n\")",
        "+ ",
        "  }",
        "+ ",
        "}",
        "\nComparison: 1999_2013\nExported summary data for 1999_2013 to species_contributions_sequential_2016_2017.csv\n\nComparison: 2013_2014\nExported summary data for 2013_2014 to species_contributions_sequential_2016_2017.csv\n\nComparison: 2014_2015\nExported summary data for 2014_2015 to species_contributions_sequential_2016_2017.csv\n\nComparison: 2015_2016\nExported summary data for 2015_2016 to species_contributions_sequential_2016_2017.csv\n\nComparison: 2016_2017\nExported summary data for 2016_2017 to species_contri",
        "butions_sequential_2016_2017.csv\n",
        "> ",
        "# Generate all possible pairs of years for arbitrary comparison",
        "> ",
        "arbitrary_year_pairs <- combn(c(\"1999\",\"2017\"), 2, simplify = FALSE)",
        "> ",
        "# Initialize a new list to store results for arbitrary year pairs",
        "> ",
        "sequential_simper_arbitrary <- list()",
        "> ",
        "# New loop for arbitrary year pairs",
        "> ",
        "for (pair in arbitrary_year_pairs) {",
        "+ ",
        "  # Extract the two years from the current pair",
        "+ ",
        "  year1 <- pair[1]",
        "+ ",
        "  year2 <- pair[2]",
        "+ ",
        "  ",
        "+ ",
        "  # Select data for these two specific years",
        "+ ",
        "  year_data <- species_matrix[env_data$Year %in% c(year1, year2), ]",
        "+ ",
        "  year_groups <- env_data$Year[env_data$Year %in% c(year1, year2)]",
        "+ ",
        "  ",
        "+ ",
        "  # Generate a unique name for this comparison",
        "+ ",
        "  comparison_name <- paste(year1, year2, sep = \"_\")",
        "+ ",
        "  ",
        "+ ",
        "  # Perform SIMPER analysis for this arbitrary pair of years",
        "+ ",
        "  sequential_simper_arbitrary[[comparison_name]] <- simper(year_data, group = year_groups, permutations = 999)",
        "+ ",
        "}",
        "> ",
        "print(\"Arbitrary Year Comparisons:\")",
        "[1] \"Arbitrary Year Comparisons:\"\n",
        "> ",
        "for(i in seq_along(sequential_simper_arbitrary)) {",
        "+ ",
        "  # Retrieve the comparison name for the arbitrary pair",
        "+ ",
        "  comparison_name <- names(sequential_simper_arbitrary)[i]",
        "+ ",
        "  years <- unlist(strsplit(comparison_name, \"_\"))",
        "+ ",
        "  year1 <- years[1]",
        "+ ",
        "  year2 <- years[2]",
        "+ ",
        "  ",
        "+ ",
        "  cat(sprintf(\"\\nComparison: %s\\n\", comparison_name))",
        "+ ",
        "  ",
        "+ ",
        "  # Process this arbitrary comparison",
        "+ ",
        "  summary_data <- summarize_one_comparison(sequential_simper_arbitrary[[i]], df_result, year1, year2, species_groups) %>%",
        "+ ",
        "    filter(Cumulative_Percent <= 70) %>%",
        "+ ",
        "    mutate(",
        "+ ",
        "      Species = format_species_names(Species)",
        "+ ",
        "    ) %>%",
        "+ ",
        "    mutate_if(is.numeric, ~ round(.x, 2))",
        "+ ",
        "  rownames(summary_data) <- NULL",
        "+ ",
        "  summary_data <- summary_data %>% mutate_if(is.numeric, ~ round(.x, 2))",
        "+ ",
        "  # Apply line breaks to column names",
        "+ ",
        "  colnames(summary_data) <- gsub(\"_\", \"<br>\", colnames(summary_data))",
        "+ ",
        "  ",
        "+ ",
        "  if(nrow(summary_data) > 0) {",
        "+ ",
        "    # Export the summary table to a CSV file",
        "+ ",
        "    #file_name <- sprintf(\"species_contributions_%s.csv\", comparison_name)",
        "+ ",
        "    #write.csv(summary_data, file = file_name, row.names = FALSE)",
        "+ ",
        "    print(",
        "+ ",
        "      kableExtra::kbl(",
        "+ ",
        "        summary_data,",
        "+ ",
        "        caption = sprintf(\"Species contributions for %s\", comparison_name),",
        "+ ",
        "        digits = 2,",
        "+ ",
        "        format = \"html\",",
        "+ ",
        "        escape = F",
        "+ ",
        "      ) %>%",
        "+ ",
        "        kableExtra::kable_styling(",
        "+ ",
        "          full_width = FALSE,",
        "+ ",
        "          bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")",
        "+ ",
        "        ) %>%",
        "+ ",
        "        kableExtra::row_spec(0, bold = TRUE, color = \"black\", background = \"#f0f0f0\") %>%  # Header styling",
        "+ ",
        "        kableExtra::column_spec(1, bold = TRUE, width = \"5em\") %>%  # First column bold",
        "+ ",
        "        kableExtra::add_header_above(c(\" \" = 1, \"Species Contributions\" = ncol(summary_data) - 1))  # Custom header",
        "+ ",
        "    )",
        "+ ",
        "  } else {",
        "+ ",
        "    cat(\"No species met the contribution threshold for this comparison.\\n\")",
        "+ ",
        "  }",
        "+ ",
        "}",
        "\nComparison: 1999_2017\n",
        "> ",
        "# Create a function to prepare data for visualization",
        "> ",
        "prepare_simper_viz_data <- function(sequential_simper, df_result, species_groups) {",
        "+ ",
        "  viz_data <- data.frame()",
        "+ ",
        "  ",
        "+ ",
        "  for(i in seq_along(sequential_simper)) {",
        "+ ",
        "    comparison_name <- names(sequential_simper)[i]",
        "+ ",
        "    years <- unlist(strsplit(comparison_name, \"_\"))",
        "+ ",
        "    year1 <- years[1]",
        "+ ",
        "    year2 <- years[2]",
        "+ ",
        "    ",
        "+ ",
        "    # Get summary data for this comparison",
        "+ ",
        "    summary_data <- summarize_one_comparison(sequential_simper[[i]], df_result, year1, year2, species_groups) %>%",
        "+ ",
        "      filter(Cumulative_Percent <= 70)",
        "+ ",
        "    ",
        "+ ",
        "    # Calculate mean abundance for each species in each year",
        "+ ",
        "    year_data <- bind_rows(",
        "+ ",
        "      df_result %>%",
        "+ ",
        "        filter(year == year1, species %in% summary_data$Species) %>%",
        "+ ",
        "        group_by(species) %>%",
        "+ ",
        "        summarise(abundance = mean(adjusted_density), year = year1),",
        "+ ",
        "      df_result %>%",
        "+ ",
        "        filter(year == year2, species %in% summary_data$Species) %>%",
        "+ ",
        "        group_by(species) %>%",
        "+ ",
        "        summarise(abundance = mean(adjusted_density), year = year2)",
        "+ ",
        "    )",
        "+ ",
        "    ",
        "+ ",
        "    # Add contribution information",
        "+ ",
        "    year_data <- year_data %>%",
        "+ ",
        "      left_join(summary_data %>% ",
        "+ ",
        "                select(Species, Individual_Percent, Ecological_Group),",
        "+ ",
        "                by = c(\"species\" = \"Species\"))",
        "+ ",
        "    ",
        "+ ",
        "    viz_data <- bind_rows(viz_data, year_data)",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  return(viz_data)",
        "+ ",
        "}",
        "> ",
        "# Prepare visualization data",
        "> ",
        "viz_data <- prepare_simper_viz_data(sequential_simper, df_result, species_groups)",
        "> ",
        "# Create main SIMPER visualization",
        "> ",
        "simper_plot <- ggplot(viz_data %>% ",
        "+ ",
        "                     filter(Individual_Percent >= 5), # Focus on major contributors",
        "+ ",
        "       aes(x = year, y = abundance, fill = factor(Ecological_Group))) +",
        "+ ",
        "  geom_bar(stat = \"identity\", position = \"dodge\") +",
        "+ ",
        "  facet_wrap(~species, scales = \"free_y\") +",
        "+ ",
        "  scale_fill_brewer(palette = \"Set2\", name = \"AMBI Group\") +",
        "+ ",
        "  theme_bw() +",
        "+ ",
        "  labs(",
        "+ ",
        "    x = \"Year\",",
        "+ ",
        "    y = expression(paste(\"Abundance (individuals/m\"^2, \")\")),",
        "+ ",
        "    title = \"Temporal changes in key species abundance (1999 and 2013-2017)\",",
        "+ ",
        "    subtitle = \"Species contributing >5% to between-year dissimilarity\"",
        "+ ",
        "  ) +",
        "+ ",
        "  theme(",
        "+ ",
        "    axis.text.x = element_text(angle = 45, hjust = 1),",
        "+ ",
        "    panel.grid.minor = element_blank(),",
        "+ ",
        "    strip.text = element_text(face = \"italic\"),",
        "+ ",
        "    legend.position = \"bottom\"",
        "+ ",
        "  )",
        "> ",
        "# Create summary table",
        "> ",
        "summary_table <- viz_data %>%",
        "+ ",
        "  group_by(species) %>%",
        "+ ",
        "  summarise(",
        "+ ",
        "    AMBI_Group = first(Ecological_Group),",
        "+ ",
        "    contribution = first(Individual_Percent),",
        "+ ",
        "    `2013` = mean(abundance[year == \"2013\"], na.rm = TRUE),",
        "+ ",
        "    `2014` = mean(abundance[year == \"2014\"], na.rm = TRUE),",
        "+ ",
        "    `2015` = mean(abundance[year == \"2015\"], na.rm = TRUE),",
        "+ ",
        "    `2016` = mean(abundance[year == \"2016\"], na.rm = TRUE),",
        "+ ",
        "    `2017` = mean(abundance[year == \"2017\"], na.rm = TRUE),",
        "+ ",
        "    .groups = 'drop'",
        "+ ",
        "  ) %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    species = format_species_names(species)",
        "+ ",
        "  ) %>%",
        "+ ",
        "  filter(rowSums(!is.na(across(starts_with(\"20\")))) > 0) %>%",
        "+ ",
        "  mutate(across(starts_with(\"20\"), ~replace_na(., 0))) %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    across(starts_with(\"20\"), ~round(., 0)),",
        "+ ",
        "    contribution = round(contribution, 1)",
        "+ ",
        "  ) %>%",
        "+ ",
        "  arrange(desc(contribution))",
        "> ",
        "# Now create the formatted table",
        "> ",
        "kableExtra::kbl(",
        "+ ",
        "  summary_table,",
        "+ ",
        "  caption = \"Species contributions to community dissimilarity (2013-2017)\",",
        "+ ",
        "  format = \"html\",",
        "+ ",
        "  col.names = c(\"Species\", \"AMBI Group\", \"% Contribution\", \"2013\", \"2014\", \"2015\", \"2016\", \"2017\"),",
        "+ ",
        "  align = c(\"l\", \"c\", \"r\", \"r\", \"r\", \"r\", \"r\", \"r\")",
        "+ ",
        ") %>%",
        "+ ",
        "  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),",
        "+ ",
        "                full_width = FALSE) %>%",
        "+ ",
        "  row_spec(0, bold = TRUE) %>%",
        "+ ",
        "  column_spec(1, italic = TRUE) %>%",
        "+ ",
        "  add_header_above(c(\" \" = 3, \"Abundance (ind./m)\" = 5))",
        "> ",
        "# Export plot and table",
        "> ",
        "ggsave(\"output/simper_temporal_changes.png\", simper_plot, ",
        "+ ",
        "       width = 12, height = 8, dpi = 300)"
    ]
}